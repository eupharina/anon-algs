<html>
<head>
<meta charset="UTF-8">
<script src="include/jquery-1.11.0.min.js"></script>

<script>
function showRow(row) {
	var censPre = document.getElementById("censored" + row);
	censPre.style.display = 'none';
	
	var codePre = document.getElementById("codeline" + row);
	codePre.style.display = 'block';
}

var puzzleNum = 0;
var totalPuzzleNum = 2;
function nextPuzzle(){
    puzzleNum = (puzzleNum + 1) % totalPuzzleNum;
    console.log("PUZZLE# " + puzzleNum);
    tableCreate();
}

var curLines
function showAnswer() {
	console.log("Show answer!");
    for (var i = 0; i < curLines; i++) {
    	showRow(i);
    }
}

function tableCreate(){
    var alg;
    var filename = "http://localhost:8000/algs/" + (puzzleNum + 1) + ".txt";
    $.ajax({//ajax method to load the board.json and call the loadBoard() function on success
      'async': false,
      'global': false,
      type:'GET',
      dataType:'text',
      url:filename,
      success:function(data){
//         $("#main-container").hide()
          alg = data;
  	console.log("loaded from " + filename);
      }
    });

    var arrayOfLines = alg.split("\n");
    curLines = arrayOfLines.length

    var tableDiv = document.getElementById("myDynamicTable")
    var tbl = document.createElement('TABLE');
    tbl.style.width  = '1000px';
    //tbl.style.border = '1px solid black';

    for(var i = 0; i < arrayOfLines.length; i++){
        var tr = tbl.insertRow();
        
        var tdNum = tr.insertCell();
        tdNum.appendChild(document.createTextNode(i));
        tdNum.style.width  = '100px';
        
        var tdLine = tr.insertCell();
//        tdLine.style.visibility = 'hidden';
//        var tdLineId = "line" + i;
//        tdLine.setAttribute("id", tdLineId);
        
        (function(index){
        	tdNum.addEventListener('click', function() {
        		showRow(index);
        	});
        })(i)
        
        // Create code element
        var codePre = document.createElement("pre");
        codePre.style.margin = "5px 0px 5px 0px";
        codePre.style.display = 'none';
        var codePreId = "codeline" + i;
        codePre.setAttribute("id", codePreId);
        
        var codeLine = arrayOfLines[i];
        codePre.appendChild(document.createTextNode(codeLine));
        

        // Create censored element
        var censPre = document.createElement("pre");
        censPre.style.margin = "5px 0px 5px 0px";
        censPre.style.display = 'block';
        var censPreId = "censored" + i;
        censPre.setAttribute("id", censPreId);
        
        var censored = codeLine.replace(/\S/g, "*");
        censPre.appendChild(document.createTextNode(censored));
        

        // Add both to the table
        tdLine.appendChild(codePre);
        tdLine.appendChild(censPre);
    }

    if (tableDiv.childNodes.length == 0)
        tableDiv.appendChild(tbl);
    else {
        tableDiv.replaceChild(tbl, tableDiv.childNodes[0]);
    }
}
</script>
</head>

<body>

	<div id="myDynamicTable"></div>

<script>
tableCreate();
</script>

	<button onclick="showAnswer()">Show answer</button>
	<button onclick="nextPuzzle()">Next puzzle</button>

</body>
</html>


