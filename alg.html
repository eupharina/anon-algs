<html>
<head>
<meta charset="UTF-8">
<script src="include/jquery-1.11.0.min.js"></script>

<script>
function toggle(hideId) {
 if( document.getElementById(hideId).style.visibility=='visible' ){
   document.getElementById(hideId).style.visibility = 'hidden';
 }else{
   document.getElementById(hideId).style.visibility = 'visible';
 }
}

var puzzleNum = 0;
var totalPuzzleNum = 2;
function nextPuzzle(){
    puzzleNum = (puzzleNum + 1) % totalPuzzleNum;
    console.log("PUZZLE# " + puzzleNum);
    tableCreate();
}

var curLines
function showAnswer() {
    for (var i = 0; i < curLines; i++) {
        var tdLineId = "line" + i;
        var tdLine = document.getElementById(tdLineId);
        tdLine.style.visibility = 'visible';
    }
}

function tableCreate(){
    var alg;
    var filename = "http://localhost:8000/algs/" + (puzzleNum + 1) + ".txt";
    $.ajax({//ajax method to load the board.json and call the loadBoard() function on success
      'async': false,
      'global': false,
      type:'GET',
      dataType:'text',
      url:filename,
      success:function(data){
//         $("#main-container").hide()
          alg = data;
  	console.log("loaded from " + filename);
      }
    });

    var arrayOfLines = alg.split("\n");
    curLines = arrayOfLines.length

    var tableDiv = document.getElementById("myDynamicTable")
    var tbl = document.createElement('TABLE');
    tbl.style.width  = '1000px';
    //tbl.style.border = '1px solid black';

    for(var i = 0; i < arrayOfLines.length; i++){
        var tr = tbl.insertRow();
        
        var tdNum = tr.insertCell();
        tdNum.appendChild(document.createTextNode(i));
        tdNum.style.width  = '100px';
        
        var tdLine = tr.insertCell();
        tdLine.style.visibility = 'hidden';
        var tdLineId = "line" + i;
        tdLine.setAttribute("id", tdLineId);
        
        (function(index){
        	tdNum.addEventListener('click', function() {
        		toggle(index);
        	});
        })(tdLineId)
        
        var codeline = document.createElement("pre");
        codeline.appendChild(document.createTextNode(arrayOfLines[i]));
        tdLine.appendChild(codeline);
    }

    if (tableDiv.childNodes.length == 0)
        tableDiv.appendChild(tbl);
    else {
        tableDiv.replaceChild(tbl, tableDiv.childNodes[0]);
    }
}
</script>
</head>

<body>

	<div id="myDynamicTable"></div>

	<script>
tableCreate();
</script>

	<button onclick="showAnswer()">                 Show answer</button>
	<button onclick="nextPuzzle()">Next puzzle</button>

</body>
</html>


